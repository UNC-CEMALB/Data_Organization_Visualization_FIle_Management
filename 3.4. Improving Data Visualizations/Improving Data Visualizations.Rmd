# Improving Data Visualizations

This training module was developed by Alexis Payton, Dr. Kyle R. Roell, and Dr. Julia E. Rager

Fall 2022

## Introduction to Training Module

Data visualizations are used to convey concepts and key takeaways from an analysis in a clear in succinct way. In environmental health research, this is of particular importance for high dimensional datasets that will typically have more results that need to be communicated to a reader. The best visualizations intentionally use 
- color
- ordering
- size
- minimal text, etc. 

to convey those concepts to the reader faster.

In this module, ggplot2, R's data visualization will be used to walk through ways to improve data visualizations. Two example figures will be built - a simple example constructing a box plot and a more complex example constructing a XXXXX?????

The data to be used in this module was described and referenced previously in [TAME Toolkit module 1.4](https://uncsrp.github.io/Data-Analysis-Training-Modules/high-dimensional-data-visualizations.html#high-dimensional-data-visualizations). Briefly, this dataset contains environmental chemistry data resulting from the analysis of 12 smoke samples from various biomasses under two different burn conditions. The first example boxplot will be built off the one found in TAME module 1.4 and this module improvements will be made to it. The second example...



### Installing required R packages
If you already have these packages installed, you can skip this step, or you can run the below code which checks installation status for you


```R
if (!requireNamespace("factoextra"))
  install.packages("factoextra");
if (!requireNamespace("MetBrewer"))
  install.packages("MetBrewer");
if (!requireNamespace("patchwork"))
  install.packages("patchwork");
if (!requireNamespace("vegan"))
  install.packages("vegan");
if (!requireNamespace("ggrepel"))
  install.packages("ggrepel");
```

    Loading required namespace: factoextra
    
    Loading required namespace: MetBrewer
    
    Loading required namespace: patchwork
    
    Loading required namespace: vegan
    


### Loading required R packages


```R
library(ggplot2)
library(tidyverse)
library(reshape2)
library(MetBrewer)
library(factoextra)
library(patchwork)
library(vegan)
library(ggrepel)
```

    â”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.1 â”€â”€
    
    [32mâœ”[39m [34mtibble [39m 3.1.6     [32mâœ”[39m [34mdplyr  [39m 1.0.8
    [32mâœ”[39m [34mtidyr  [39m 1.2.0     [32mâœ”[39m [34mstringr[39m 1.4.0
    [32mâœ”[39m [34mreadr  [39m 2.1.2     [32mâœ”[39m [34mforcats[39m 0.5.1
    [32mâœ”[39m [34mpurrr  [39m 0.3.4     
    
    â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
    [31mâœ–[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
    [31mâœ–[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
    
    
    Attaching package: â€˜reshape2â€™
    
    
    The following object is masked from â€˜package:tidyrâ€™:
    
        smiths
    
    
    Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
    
    Loading required package: permute
    
    Loading required package: lattice
    
    This is vegan 2.6-2
    


### Set your working directory


```R
setwd("/filepath to where your input files are")
```

### Importing example dataset
Then let's read in our example dataset. As mentioned in the introduction, this example dataset represents chemical measurements across 12 different biomass burn scenarios, representing potential wildfire events. Let's upload and view these data:


```R
# Load the data
SmokeData1 <- read.csv("Input/ModuleData.csv")

# View the top of the dataset
head(SmokeData1) 
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 14</caption>
<thead>
	<tr><th></th><th scope=col>Chemical.Category</th><th scope=col>Chemical</th><th scope=col>CASRN</th><th scope=col>EucalyptusFlaming</th><th scope=col>EucalyptusSmoldering</th><th scope=col>PeatFlaming</th><th scope=col>PeatSmoldering</th><th scope=col>PineNeedlesFlaming</th><th scope=col>PineNeedlesSmoldering</th><th scope=col>PineFlaming</th><th scope=col>PineSmoldering</th><th scope=col>RedOakFlaming</th><th scope=col>RedOakSmoldering</th><th scope=col>Units</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>n-Alkanes</td><td>2-Methylnonadecane</td><td>1560-86-7</td><td>0.06</td><td>0.06</td><td>0.06</td><td>1.36</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.13</td><td>0.06</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>2</th><td>n-Alkanes</td><td>3-Methylnonadecane</td><td>6418-45-7</td><td>0.04</td><td>0.04</td><td>0.90</td><td>1.13</td><td>0.72</td><td>0.04</td><td>0.04</td><td>0.47</td><td>0.77</td><td>0.04</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>3</th><td>n-Alkanes</td><td>Docosane          </td><td>629-97-0 </td><td>0.25</td><td>0.21</td><td>0.57</td><td>9.46</td><td>0.18</td><td>0.32</td><td>0.48</td><td>0.16</td><td>0.36</td><td>0.16</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>4</th><td>n-Alkanes</td><td>Dodecylcyclohexane</td><td>1795-17-1</td><td>0.04</td><td>0.04</td><td>0.04</td><td>0.25</td><td>0.04</td><td>0.12</td><td>0.04</td><td>0.04</td><td>0.04</td><td>0.04</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>5</th><td>n-Alkanes</td><td>Eicosane          </td><td>112-95-8 </td><td>0.25</td><td>0.11</td><td>0.54</td><td>7.55</td><td>0.16</td><td>0.28</td><td>0.29</td><td>0.17</td><td>0.38</td><td>0.15</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>6</th><td>n-Alkanes</td><td>Heneicosane       </td><td>629-94-7 </td><td>0.28</td><td>0.13</td><td>0.34</td><td>6.77</td><td>0.13</td><td>0.30</td><td>0.42</td><td>0.13</td><td>0.69</td><td>0.13</td><td>ng_per_uL</td></tr>
</tbody>
</table>



Now that we've been able to view the dataset, let's come up with a question that can be answered with our boxplot figure. This will inform how we format the dataframe for visualization.

## Traning Module's Environmental Health Questions 
This training module was specifically developed to answer the following environmental health questions:
1. Which biomass burn condition has the greatest chemical concentration?
2. ?

### Formatting dataframes for downstream visualization code
For some of the visualizations below (e.g., heat maps) weâ€™ll use data from the original full dataframe. The only formatting that needs to be done to this dataframe is to move the chemical names to the row names position of the dataframe:


```R
# Converting the chemical category column to row names
SmokeData2 = SmokeData1 %>%
    column_to_rownames(var = "Chemical")

# View the top of the reorganized dataset
head(SmokeData2)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 13</caption>
<thead>
	<tr><th></th><th scope=col>Chemical.Category</th><th scope=col>CASRN</th><th scope=col>EucalyptusFlaming</th><th scope=col>EucalyptusSmoldering</th><th scope=col>PeatFlaming</th><th scope=col>PeatSmoldering</th><th scope=col>PineNeedlesFlaming</th><th scope=col>PineNeedlesSmoldering</th><th scope=col>PineFlaming</th><th scope=col>PineSmoldering</th><th scope=col>RedOakFlaming</th><th scope=col>RedOakSmoldering</th><th scope=col>Units</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>2-Methylnonadecane</th><td>n-Alkanes</td><td>1560-86-7</td><td>0.06</td><td>0.06</td><td>0.06</td><td>1.36</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.13</td><td>0.06</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>3-Methylnonadecane</th><td>n-Alkanes</td><td>6418-45-7</td><td>0.04</td><td>0.04</td><td>0.90</td><td>1.13</td><td>0.72</td><td>0.04</td><td>0.04</td><td>0.47</td><td>0.77</td><td>0.04</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>Docosane</th><td>n-Alkanes</td><td>629-97-0 </td><td>0.25</td><td>0.21</td><td>0.57</td><td>9.46</td><td>0.18</td><td>0.32</td><td>0.48</td><td>0.16</td><td>0.36</td><td>0.16</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>Dodecylcyclohexane</th><td>n-Alkanes</td><td>1795-17-1</td><td>0.04</td><td>0.04</td><td>0.04</td><td>0.25</td><td>0.04</td><td>0.12</td><td>0.04</td><td>0.04</td><td>0.04</td><td>0.04</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>Eicosane</th><td>n-Alkanes</td><td>112-95-8 </td><td>0.25</td><td>0.11</td><td>0.54</td><td>7.55</td><td>0.16</td><td>0.28</td><td>0.29</td><td>0.17</td><td>0.38</td><td>0.15</td><td>ng_per_uL</td></tr>
	<tr><th scope=row>Heneicosane</th><td>n-Alkanes</td><td>629-94-7 </td><td>0.28</td><td>0.13</td><td>0.34</td><td>6.77</td><td>0.13</td><td>0.30</td><td>0.42</td><td>0.13</td><td>0.69</td><td>0.13</td><td>ng_per_uL</td></tr>
</tbody>
</table>




```R
# Creating a smaller dataframe to work with 
SmokeData3 = SmokeData2[,3:12]

# Viewing the dataframe
head(SmokeData3)

# scaling the data
ScaledData = t(scale(t(SmokeData3)))
head(ScaledData)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 10</caption>
<thead>
	<tr><th></th><th scope=col>EucalyptusFlaming</th><th scope=col>EucalyptusSmoldering</th><th scope=col>PeatFlaming</th><th scope=col>PeatSmoldering</th><th scope=col>PineNeedlesFlaming</th><th scope=col>PineNeedlesSmoldering</th><th scope=col>PineFlaming</th><th scope=col>PineSmoldering</th><th scope=col>RedOakFlaming</th><th scope=col>RedOakSmoldering</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>2-Methylnonadecane</th><td>0.06</td><td>0.06</td><td>0.06</td><td>1.36</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.06</td><td>0.13</td><td>0.06</td></tr>
	<tr><th scope=row>3-Methylnonadecane</th><td>0.04</td><td>0.04</td><td>0.90</td><td>1.13</td><td>0.72</td><td>0.04</td><td>0.04</td><td>0.47</td><td>0.77</td><td>0.04</td></tr>
	<tr><th scope=row>Docosane</th><td>0.25</td><td>0.21</td><td>0.57</td><td>9.46</td><td>0.18</td><td>0.32</td><td>0.48</td><td>0.16</td><td>0.36</td><td>0.16</td></tr>
	<tr><th scope=row>Dodecylcyclohexane</th><td>0.04</td><td>0.04</td><td>0.04</td><td>0.25</td><td>0.04</td><td>0.12</td><td>0.04</td><td>0.04</td><td>0.04</td><td>0.04</td></tr>
	<tr><th scope=row>Eicosane</th><td>0.25</td><td>0.11</td><td>0.54</td><td>7.55</td><td>0.16</td><td>0.28</td><td>0.29</td><td>0.17</td><td>0.38</td><td>0.15</td></tr>
	<tr><th scope=row>Heneicosane</th><td>0.28</td><td>0.13</td><td>0.34</td><td>6.77</td><td>0.13</td><td>0.30</td><td>0.42</td><td>0.13</td><td>0.69</td><td>0.13</td></tr>
</tbody>
</table>




<table class="dataframe">
<caption>A matrix: 6 Ã— 10 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>EucalyptusFlaming</th><th scope=col>EucalyptusSmoldering</th><th scope=col>PeatFlaming</th><th scope=col>PeatSmoldering</th><th scope=col>PineNeedlesFlaming</th><th scope=col>PineNeedlesSmoldering</th><th scope=col>PineFlaming</th><th scope=col>PineSmoldering</th><th scope=col>RedOakFlaming</th><th scope=col>RedOakSmoldering</th></tr>
</thead>
<tbody>
	<tr><th scope=row>2-Methylnonadecane</th><td>-0.3347765</td><td>-0.3347765</td><td>-0.3347765</td><td>2.841935</td><td>-0.3347765</td><td>-0.3347765</td><td>-0.3347765</td><td>-0.3347765</td><td>-0.1637228</td><td>-0.3347765</td></tr>
	<tr><th scope=row>3-Methylnonadecane</th><td>-0.8794448</td><td>-0.8794448</td><td> 1.1161291</td><td>1.649829</td><td> 0.6984509</td><td>-0.8794448</td><td>-0.8794448</td><td> 0.1183422</td><td> 0.8144726</td><td>-0.8794448</td></tr>
	<tr><th scope=row>Docosane</th><td>-0.3327216</td><td>-0.3465132</td><td>-0.2223890</td><td>2.842787</td><td>-0.3568568</td><td>-0.3085863</td><td>-0.2534201</td><td>-0.3637526</td><td>-0.2947948</td><td>-0.3637526</td></tr>
	<tr><th scope=row>Dodecylcyclohexane</th><td>-0.4240624</td><td>-0.4240624</td><td>-0.4240624</td><td>2.646734</td><td>-0.4240624</td><td> 0.7457649</td><td>-0.4240624</td><td>-0.4240624</td><td>-0.4240624</td><td>-0.4240624</td></tr>
	<tr><th scope=row>Eicosane</th><td>-0.3195928</td><td>-0.3802202</td><td>-0.1940076</td><td>2.841691</td><td>-0.3585675</td><td>-0.3066012</td><td>-0.3022707</td><td>-0.3542370</td><td>-0.2632960</td><td>-0.3628981</td></tr>
	<tr><th scope=row>Heneicosane</th><td>-0.3166775</td><td>-0.3895328</td><td>-0.2875354</td><td>2.835527</td><td>-0.3895328</td><td>-0.3069635</td><td>-0.2486793</td><td>-0.3895328</td><td>-0.1175398</td><td>-0.3895328</td></tr>
</tbody>
</table>




```R
# Melting the data, which converts the data into a longer format 
ScaledData.melt <- melt(ScaledData)

# Updating the column names
colnames(ScaledData.melt) <- c("Chemical", "Biomass_Burn_Condition", 
                               "Scaled_Chemical_Concentration") 
head(ScaledData.melt)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 3</caption>
<thead>
	<tr><th></th><th scope=col>Chemical</th><th scope=col>Biomass_Burn_Condition</th><th scope=col>Scaled_Chemical_Concentration</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>2-Methylnonadecane</td><td>EucalyptusFlaming</td><td>-0.3347765</td></tr>
	<tr><th scope=row>2</th><td>3-Methylnonadecane</td><td>EucalyptusFlaming</td><td>-0.8794448</td></tr>
	<tr><th scope=row>3</th><td>Docosane          </td><td>EucalyptusFlaming</td><td>-0.3327216</td></tr>
	<tr><th scope=row>4</th><td>Dodecylcyclohexane</td><td>EucalyptusFlaming</td><td>-0.4240624</td></tr>
	<tr><th scope=row>5</th><td>Eicosane          </td><td>EucalyptusFlaming</td><td>-0.3195928</td></tr>
	<tr><th scope=row>6</th><td>Heneicosane       </td><td>EucalyptusFlaming</td><td>-0.3166775</td></tr>
</tbody>
</table>



### Original Version from TAME Module 1.4


```R
options(repr.plot.width=8, repr.plot.height=7) #changing size
ggplot(data = ScaledData.melt, aes(x = Scaled_Chemical_Concentration, color = Biomass_Burn_Condition)) + 
  geom_boxplot()
```


    
![png](output_13_0.png)
    


### There are three main aspects we can adjust on this figure:
 **1. The order of the box plots.**
 
   Ordering the biomass burn conditions from highest to lowest based on their median scaled chemical concentration allows the reader to easily determine the biomass burn condition that had the greatest or least chemical concentrations relative to each other. In R, this can be done by putting the biomass_burn_condition variable into a factor.
      
**2. The legibility of the text in the legend and axes.**

   Creating spaces between the text or exchanging the underscores for spaces improves the legibility of the figure. 
     
**3. Use of color.**

   In figures variables can be visualized using color, text, size, etc. In this figure, it is redundant to have the biomass burn condition encoded in the legend and the color. Instead this variable can be put on the y axis and the legend will be removed to be more concise. The shades of the colors will also be changed, but to keep each burn condition distinct colors will be chosen that are distinct from one another. 


```R
# First adding spaces beteween the biomass burn conditions
ScaledData.melt.spaces = ScaledData.melt %>%
    mutate(Biomass_Burn_Condition = ifelse(Biomass_Burn_Condition =="RedOakSmoldering", "Red Oak Smoldering",
                ifelse(Biomass_Burn_Condition =="RedOakFlaming", "Red Oak Flaming",
                    ifelse(Biomass_Burn_Condition =="EucalyptusSmoldering", "Eucalyptus Smoldering",
                        ifelse(Biomass_Burn_Condition =="EucalyptusFlaming", "Eucalyptus Flaming",
                            ifelse(Biomass_Burn_Condition =="PineSmoldering", "Pine Smoldering",
                                ifelse(Biomass_Burn_Condition =="PineFlaming", "Pine Flaming",
                                    ifelse(Biomass_Burn_Condition =="PineNeedlesSmoldering", "Pine Needles Smoldering",
                                        ifelse(Biomass_Burn_Condition =="PineNeedlesFlaming", "Pine Needles Flaming",
                                            ifelse(Biomass_Burn_Condition =="PeatSmoldering", "Peat Smoldering",
                                                  ifelse(Biomass_Burn_Condition =="PeatFlaming", "Peat Flaming",
                                                         NA)))))))))))
# Viewing dataframe
head(ScaledData.melt.spaces)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 3</caption>
<thead>
	<tr><th></th><th scope=col>Chemical</th><th scope=col>Biomass_Burn_Condition</th><th scope=col>Scaled_Chemical_Concentration</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>2-Methylnonadecane</td><td>Eucalyptus Flaming</td><td>-0.3347765</td></tr>
	<tr><th scope=row>2</th><td>3-Methylnonadecane</td><td>Eucalyptus Flaming</td><td>-0.8794448</td></tr>
	<tr><th scope=row>3</th><td>Docosane          </td><td>Eucalyptus Flaming</td><td>-0.3327216</td></tr>
	<tr><th scope=row>4</th><td>Dodecylcyclohexane</td><td>Eucalyptus Flaming</td><td>-0.4240624</td></tr>
	<tr><th scope=row>5</th><td>Eicosane          </td><td>Eucalyptus Flaming</td><td>-0.3195928</td></tr>
	<tr><th scope=row>6</th><td>Heneicosane       </td><td>Eucalyptus Flaming</td><td>-0.3166775</td></tr>
</tbody>
</table>




```R
# Factor the biomass_burn_condition by the median scaled_chemical_concentration
median_concentration_data = ScaledData.melt.spaces %>%
    group_by(Biomass_Burn_Condition) %>%
    summarize(Median_Concentration = median(Scaled_Chemical_Concentration)) %>%
    arrange(Median_Concentration)

head(median_concentration_data)

# Saving that order
median_biomass_order = median_concentration_data$Biomass_Burn_Condition
```


<table class="dataframe">
<caption>A tibble: 6 Ã— 2</caption>
<thead>
	<tr><th scope=col>Biomass_Burn_Condition</th><th scope=col>Median_Concentration</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Red Oak Smoldering     </td><td>-0.4590961</td></tr>
	<tr><td>Eucalyptus Smoldering  </td><td>-0.4508589</td></tr>
	<tr><td>Pine Smoldering        </td><td>-0.4244289</td></tr>
	<tr><td>Pine Needles Smoldering</td><td>-0.3702707</td></tr>
	<tr><td>Pine Needles Flaming   </td><td>-0.3498902</td></tr>
	<tr><td>Red Oak Flaming        </td><td>-0.3373308</td></tr>
</tbody>
</table>



### Improved Version


```R
options(repr.plot.width=7, repr.plot.height=7) #changing size

# Putting into factor to organize the burn conditions
ScaledData.melt.spaces$Biomass_Burn_Condition = factor(ScaledData.melt.spaces$Biomass_Burn_Condition, levels = median_biomass_order)

# Choosing palette from package
metbrewer_colors = met.brewer(name = "Juarez", n = 12)[1:12]

ggplot(data = ScaledData.melt.spaces, aes(x = Scaled_Chemical_Concentration, y = Biomass_Burn_Condition, 
                                   color = Biomass_Burn_Condition)) + 
  geom_boxplot() +
  geom_point(position = position_jitter(h = 0.1)) + # jittering the points, so they're not all on top of each other

  theme_light() + # changing the theme
  theme(axis.text = element_text(size = 12), # changing size of x axis labels
      axis.title = element_text(face = "bold", size = rel(1.7)), # changes axis titles
      legend.position = "none") + # changes legend text

  xlab('Scaled Chemical Concentration (pg/uL)') + ylab('Biomass Burn Condition') + # changing axis labels 
  scale_color_manual(values = c(metbrewer_colors))
```


    
![png](output_18_0.png)
    


You may notice that the scaled chemical concentration was put on the x axis and burn condition was put on the y axis and not vice versa. When names are longer the names are more legible if that variable is placed on the y axis.

Other aspects of the figure were changed in the latest version, but those are minor compared to changing the order of the boxplots, revamping the text, and the usage of color. RStudio provides a [ggplot2 cheat sheet](https://www.rstudio.com/resources/cheatsheets/) for changing a figure's parameters. 

# Question #2: 

### Importing example dataset
This dataset contains...


```R
library(readxl)

cytokine_data = data.frame(read_excel("Input/CytokineData_102920.xlsx", sheet = 2))

# View the top of the dataset
head(cytokine_data)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 8</caption>
<thead>
	<tr><th></th><th scope=col>Original_Identifier</th><th scope=col>Protein</th><th scope=col>Conc</th><th scope=col>Conc_pslog2</th><th scope=col>Compartment</th><th scope=col>SubjectNo</th><th scope=col>Group</th><th scope=col>SubjectID</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>E_C_F_002</td><td>IFNg   </td><td> 17.642316</td><td>4.220509</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
	<tr><th scope=row>2</th><td>E_C_F_002</td><td>IL10   </td><td>  2.873724</td><td>1.953721</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
	<tr><th scope=row>3</th><td>E_C_F_002</td><td>IL12p70</td><td>  1.625272</td><td>1.392467</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
	<tr><th scope=row>4</th><td>E_C_F_002</td><td>IL13   </td><td> 36.117692</td><td>5.214035</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
	<tr><th scope=row>5</th><td>E_C_F_002</td><td>IL1b   </td><td>104.409217</td><td>6.719857</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
	<tr><th scope=row>6</th><td>E_C_F_002</td><td>IL6    </td><td> 21.159536</td><td>4.469856</td><td>NELF</td><td>1</td><td>NS</td><td>NS_1</td></tr>
</tbody>
</table>



### Formatting dataframe for downstream visualization code


```R
# Splitting the dataframe within each category to perform PCA on each compartment separately
split_cytokine_data = cytokine_data %>%
    group_by(Compartment) %>%
    group_split()

NLF_data = split_cytokine_data[[2]] # NLF
NELF_data = split_cytokine_data[[1]] # NELF
sputum_data = split_cytokine_data[[4]] # sputum
serum_data = split_cytokine_data[[3]] # serum

# Reshaping the data putting subject ids as the rows and the protein as the columns
pca_prep_NLF_data <- reshape2::dcast(NLF_data, SubjectID ~ Protein, value.var ="Conc_pslog2") %>% 
  column_to_rownames("SubjectID") 
pca_prep_NELF_data <- reshape2::dcast(NELF_data, SubjectID ~ Protein, value.var ="Conc_pslog2") %>% 
  column_to_rownames("SubjectID") 
pca_prep_sputum_data <- reshape2::dcast(sputum_data, SubjectID ~ Protein, value.var ="Conc_pslog2") %>% 
  column_to_rownames("SubjectID") 
pca_prep_serum_data <- reshape2::dcast(serum_data, SubjectID ~ Protein, value.var ="Conc_pslog2") %>% 
  column_to_rownames("SubjectID") 

# Background filter eliminating any cytokines that are not expressed in a compartment  
pca_prep_NLF_data$I309 <- NULL
pca_prep_sputum_data$I309 <- NULL

# Viewing data
head(pca_prep_NLF_data)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 21</caption>
<thead>
	<tr><th></th><th scope=col>Eotaxin</th><th scope=col>Eotaxin3</th><th scope=col>Fractalkine</th><th scope=col>IFNg</th><th scope=col>IL10</th><th scope=col>IL12p70</th><th scope=col>IL13</th><th scope=col>IL17B</th><th scope=col>IL17D</th><th scope=col>IL1b</th><th scope=col>â‹¯</th><th scope=col>IL6</th><th scope=col>IL8</th><th scope=col>IP10</th><th scope=col>ITAC</th><th scope=col>MCP1</th><th scope=col>MIG</th><th scope=col>MIP1a</th><th scope=col>MIP1b</th><th scope=col>TARC</th><th scope=col>TNFa</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>â‹¯</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>CS_15</th><td>0.000000</td><td>3.038643</td><td> 9.636227</td><td>0.000000</td><td>0.14893463</td><td>0.07469627</td><td>2.207063</td><td>0.6256351</td><td>1.8301329</td><td>1.107784</td><td>â‹¯</td><td>0.3908391</td><td> 9.086325</td><td> 7.061425</td><td>3.498878</td><td>5.441440</td><td> 8.537734</td><td>2.221396</td><td>1.707346</td><td>0.000000</td><td>0.51280805</td></tr>
	<tr><th scope=row>CS_16</th><td>6.163727</td><td>3.613655</td><td>10.187516</td><td>1.950766</td><td>1.27894590</td><td>0.65261981</td><td>4.469849</td><td>2.3134686</td><td>2.9811763</td><td>5.618246</td><td>â‹¯</td><td>3.5291829</td><td>10.849439</td><td>10.185456</td><td>5.843138</td><td>6.378714</td><td> 9.624979</td><td>3.399035</td><td>4.104372</td><td>1.948876</td><td>2.85911002</td></tr>
	<tr><th scope=row>CS_17</th><td>3.713489</td><td>3.700294</td><td>11.048498</td><td>0.000000</td><td>0.13293875</td><td>0.92715290</td><td>3.367642</td><td>3.1315019</td><td>1.1597726</td><td>3.036496</td><td>â‹¯</td><td>4.1125851</td><td>11.153075</td><td> 9.734703</td><td>2.169828</td><td>6.349178</td><td> 6.100281</td><td>1.974294</td><td>3.042272</td><td>1.993956</td><td>1.34720761</td></tr>
	<tr><th scope=row>CS_18</th><td>5.192319</td><td>3.725884</td><td>10.853572</td><td>2.046930</td><td>0.08873065</td><td>0.00000000</td><td>1.354363</td><td>3.4258250</td><td>0.7740756</td><td>2.584225</td><td>â‹¯</td><td>1.0910076</td><td> 9.780520</td><td>13.189708</td><td>4.766194</td><td>5.381405</td><td> 9.516039</td><td>2.634565</td><td>2.549122</td><td>2.683546</td><td>0.08963907</td></tr>
	<tr><th scope=row>CS_19</th><td>7.690446</td><td>3.313601</td><td>11.180747</td><td>3.456155</td><td>1.61110773</td><td>1.25875198</td><td>4.999383</td><td>2.9672221</td><td>3.5146895</td><td>5.591556</td><td>â‹¯</td><td>6.2319868</td><td>10.870907</td><td>11.405130</td><td>7.329651</td><td>6.657583</td><td>11.704121</td><td>4.280921</td><td>5.847280</td><td>3.680552</td><td>3.59674526</td></tr>
	<tr><th scope=row>CS_20</th><td>5.649213</td><td>4.553713</td><td>12.542214</td><td>0.000000</td><td>0.10019654</td><td>0.71096657</td><td>2.103436</td><td>3.5997751</td><td>0.9149816</td><td>2.221075</td><td>â‹¯</td><td>2.6196326</td><td>10.280923</td><td> 9.715958</td><td>2.024822</td><td>7.051569</td><td> 6.106692</td><td>4.160397</td><td>3.876557</td><td>3.765043</td><td>0.78475311</td></tr>
</tbody>
</table>



### Performing PCA


```R
pca_NLF = prcomp(pca_prep_NLF_data, scale = TRUE, center = TRUE)
pca_NELF = prcomp(pca_prep_NELF_data, scale = TRUE, center = TRUE)
pca_sputum = prcomp(pca_prep_sputum_data, scale = TRUE, center = TRUE)
pca_serum = prcomp(pca_prep_serum_data, scale = TRUE, center = TRUE)

# Viewing scree plots to see how much of the variance was captured in first 2 eigenvectors
options(repr.plot.width=15, repr.plot.height=8) #changing size

pca_plot_NLF = fviz_eig(pca_NLF, addlabels = TRUE, center = TRUE) + ggtitle("NLF")
pca_plot_NELF = fviz_eig(pca_NELF, addlabels = TRUE, center = TRUE) + ggtitle("NELF")
pca_plot_sputum = fviz_eig(pca_sputum, addlabels = TRUE, center = TRUE) + ggtitle("Sputum")
pca_plot_serum = fviz_eig(pca_serum, addlabels = TRUE, center = TRUE) + ggtitle("Serum")


# Using the patchwork function to view all the plots together
pca_plot_NLF + pca_plot_NELF + pca_plot_sputum + pca_plot_serum
```


    
![png](output_24_0.png)
    


### Extracting eigenvector values


```R
get_scores = function(pca_dataframe, original_dataframe, compartment_name){
    # Creating a function to obtain the PCA eigenvector values or scores
    compartment_scores = data.frame(scores(pca_dataframe))
    
    # Converting the row names (subject ids) into a column
    compartment_scores = compartment_scores %>%
        rownames_to_column(var = "SubjectID")
    
    # Adding in a column that species the group and cytokine concentration
    compartment_scores = inner_join(original_dataframe %>%
                         select(c("SubjectID", "Group", "Conc_pslog2")), compartment_scores)
    
    # Adding a column that specifies the compartment
    compartment_scores$Compartment = rep(compartment_name, times = length(compartment_scores$PC1))
    
    return(compartment_scores)
}

# Calling function
NLF_scores <- get_scores(pca_NLF, cytokine_data, "NLF")
NELF_scores <- get_scores(pca_NELF, cytokine_data, "NELF")
sputum_scores <- get_scores(pca_sputum, cytokine_data, "Sputum")
serum_scores <- get_scores(pca_serum, cytokine_data, "Serum")

# Viewing one dataframe
head(NLF_scores)
```

    [1m[22mJoining, by = "SubjectID"
    [1m[22mJoining, by = "SubjectID"
    [1m[22mJoining, by = "SubjectID"
    [1m[22mJoining, by = "SubjectID"



<table class="dataframe">
<caption>A data.frame: 6 Ã— 25</caption>
<thead>
	<tr><th></th><th scope=col>SubjectID</th><th scope=col>Group</th><th scope=col>Conc_pslog2</th><th scope=col>PC1</th><th scope=col>PC2</th><th scope=col>PC3</th><th scope=col>PC4</th><th scope=col>PC5</th><th scope=col>PC6</th><th scope=col>PC7</th><th scope=col>â‹¯</th><th scope=col>PC13</th><th scope=col>PC14</th><th scope=col>PC15</th><th scope=col>PC16</th><th scope=col>PC17</th><th scope=col>PC18</th><th scope=col>PC19</th><th scope=col>PC20</th><th scope=col>PC21</th><th scope=col>Compartment</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>â‹¯</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>NS_1</td><td>NS</td><td>4.220509</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
	<tr><th scope=row>2</th><td>NS_1</td><td>NS</td><td>1.953721</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
	<tr><th scope=row>3</th><td>NS_1</td><td>NS</td><td>1.392467</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
	<tr><th scope=row>4</th><td>NS_1</td><td>NS</td><td>5.214035</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
	<tr><th scope=row>5</th><td>NS_1</td><td>NS</td><td>6.719857</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
	<tr><th scope=row>6</th><td>NS_1</td><td>NS</td><td>4.469856</td><td>0.463357</td><td>1.898504</td><td>0.79337</td><td>-0.9877203</td><td>-1.909841</td><td>-1.335466</td><td>-0.06506033</td><td>â‹¯</td><td>-0.5439747</td><td>0.2781744</td><td>-0.09106686</td><td>-0.1165704</td><td>-0.2626601</td><td>0.3388554</td><td>0.1926412</td><td>0.3867641</td><td>-0.1183049</td><td>NLF</td></tr>
</tbody>
</table>



### Computing the shape of each cluster based on tobacco product use


```R
get_convex_hulls = function(compartment_scores){
    # Creating a function to calculate hull values, which specify the shape of each cluster or exposure group
    grp.NS <- compartment_scores[compartment_scores$Group == "NS", ][chull(compartment_scores %>% filter(Group == "NS") %>% select(PC1, PC2) ), ]
    grp.CS <- compartment_scores[compartment_scores$Group == "CS", ][chull(compartment_scores %>% filter(Group == "CS") %>% select(PC1, PC2) ), ]
    grp.Ecig <- compartment_scores[compartment_scores$Group == "Ecig", ][chull(compartment_scores %>% filter(Group == "Ecig") %>% select(PC1, PC2) ), ]
    
    all_hulls_compartment <- rbind(grp.NS, grp.CS, grp.Ecig)
    
    return(all_hulls_compartment)
}

# Calling function

NLF_hulls <- get_convex_hulls(NLF_scores)
NELF_hulls <- get_convex_hulls(NELF_scores)
sputum_hulls <- get_convex_hulls(sputum_scores)
serum_hulls <- get_convex_hulls(serum_scores)

# Viewing one dataframe
head(NLF_hulls)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 25</caption>
<thead>
	<tr><th></th><th scope=col>SubjectID</th><th scope=col>Group</th><th scope=col>Conc_pslog2</th><th scope=col>PC1</th><th scope=col>PC2</th><th scope=col>PC3</th><th scope=col>PC4</th><th scope=col>PC5</th><th scope=col>PC6</th><th scope=col>PC7</th><th scope=col>â‹¯</th><th scope=col>PC13</th><th scope=col>PC14</th><th scope=col>PC15</th><th scope=col>PC16</th><th scope=col>PC17</th><th scope=col>PC18</th><th scope=col>PC19</th><th scope=col>PC20</th><th scope=col>PC21</th><th scope=col>Compartment</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>â‹¯</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>617</th><td>NS_8</td><td>NS</td><td> 4.10482</td><td> 5.895808</td><td>-2.4970339</td><td> 1.7729491</td><td>-0.2252802</td><td> 2.1000431</td><td> 0.38364357</td><td> 0.5960303</td><td>â‹¯</td><td> 0.345267354</td><td> 0.1336766</td><td> 0.17016166</td><td>-0.44146791</td><td>-0.393191257</td><td>-0.2565284</td><td>-0.19947000</td><td> 0.09538515</td><td> 0.00359428</td><td>NLF</td></tr>
	<tr><th scope=row>616</th><td>NS_7</td><td>NS</td><td>15.67143</td><td> 1.598828</td><td>-2.9971611</td><td>-0.1729810</td><td>-1.1609734</td><td> 0.2752894</td><td> 1.01574182</td><td>-2.0626563</td><td>â‹¯</td><td>-0.426883238</td><td>-0.3022027</td><td>-0.25703908</td><td> 0.44473737</td><td>-0.008069723</td><td> 0.3502715</td><td> 0.18235774</td><td>-0.25409770</td><td>-0.15086942</td><td>NLF</td></tr>
	<tr><th scope=row>792</th><td>NS_9</td><td>NS</td><td>15.09329</td><td>-1.987749</td><td>-2.0109247</td><td>-0.2417217</td><td>-0.3144934</td><td> 0.3838955</td><td>-0.77628508</td><td>-0.5255726</td><td>â‹¯</td><td>-0.992513596</td><td>-0.1714712</td><td> 0.08405052</td><td>-0.09729486</td><td> 0.313107286</td><td>-0.2641495</td><td>-0.03364114</td><td> 0.04515776</td><td>-0.05539403</td><td>NLF</td></tr>
	<tr><th scope=row>528</th><td>NS_6</td><td>NS</td><td>14.47520</td><td>-4.300364</td><td>-0.3413821</td><td>-1.0922365</td><td> 0.5102077</td><td>-0.8211334</td><td>-0.01307152</td><td> 0.1818809</td><td>â‹¯</td><td> 0.005351232</td><td> 0.1625341</td><td> 0.34398932</td><td>-0.43698417</td><td> 0.016907217</td><td> 0.6547679</td><td>-0.13599844</td><td>-0.11213850</td><td>-0.16421922</td><td>NLF</td></tr>
	<tr><th scope=row>527</th><td>NS_6</td><td>NS</td><td>11.06131</td><td>-4.300364</td><td>-0.3413821</td><td>-1.0922365</td><td> 0.5102077</td><td>-0.8211334</td><td>-0.01307152</td><td> 0.1818809</td><td>â‹¯</td><td> 0.005351232</td><td> 0.1625341</td><td> 0.34398932</td><td>-0.43698417</td><td> 0.016907217</td><td> 0.6547679</td><td>-0.13599844</td><td>-0.11213850</td><td>-0.16421922</td><td>NLF</td></tr>
	<tr><th scope=row>526</th><td>NS_6</td><td>NS</td><td>10.27421</td><td>-4.300364</td><td>-0.3413821</td><td>-1.0922365</td><td> 0.5102077</td><td>-0.8211334</td><td>-0.01307152</td><td> 0.1818809</td><td>â‹¯</td><td> 0.005351232</td><td> 0.1625341</td><td> 0.34398932</td><td>-0.43698417</td><td> 0.016907217</td><td> 0.6547679</td><td>-0.13599844</td><td>-0.11213850</td><td>-0.16421922</td><td>NLF</td></tr>
</tbody>
</table>



### Coercing into one dataframe for easier plotting


```R
eigenvector_values = rbind(NLF_scores[,c(1:5,25)], NELF_scores[,c(1:5,26)], sputum_scores[,c(1:5,25)], serum_scores[,c(1:5,26)])
hull_values = rbind(NLF_hulls[,c(1:5,25)], NELF_hulls[,c(1:5,26)], sputum_hulls[,c(1:5,25)], serum_hulls[,c(1:5,26)])

# Putting the compartment and group into a factor to specify the order in the plot below
eigenvector_values$Compartment = factor(eigenvector_values$Compartment, levels = c("NLF", "NELF", "Sputum", "Serum"))
hull_values$Compartment = factor(hull_values$Compartment, levels = c("NLF", "NELF", "Sputum", "Serum"))

eigenvector_values$Group = factor(eigenvector_values$Group, levels = c("NS", "CS", "Ecig"))
hull_values$Group = factor(hull_values$Group, levels = c("NS", "CS", "Ecig"))

# Viewing data
head(eigenvector_values)
head(hull_values)
```


<table class="dataframe">
<caption>A data.frame: 6 Ã— 6</caption>
<thead>
	<tr><th></th><th scope=col>SubjectID</th><th scope=col>Group</th><th scope=col>Conc_pslog2</th><th scope=col>PC1</th><th scope=col>PC2</th><th scope=col>Compartment</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>NS_1</td><td>NS</td><td>4.220509</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
	<tr><th scope=row>2</th><td>NS_1</td><td>NS</td><td>1.953721</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
	<tr><th scope=row>3</th><td>NS_1</td><td>NS</td><td>1.392467</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
	<tr><th scope=row>4</th><td>NS_1</td><td>NS</td><td>5.214035</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
	<tr><th scope=row>5</th><td>NS_1</td><td>NS</td><td>6.719857</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
	<tr><th scope=row>6</th><td>NS_1</td><td>NS</td><td>4.469856</td><td>0.463357</td><td>1.898504</td><td>NLF</td></tr>
</tbody>
</table>




<table class="dataframe">
<caption>A data.frame: 6 Ã— 6</caption>
<thead>
	<tr><th></th><th scope=col>SubjectID</th><th scope=col>Group</th><th scope=col>Conc_pslog2</th><th scope=col>PC1</th><th scope=col>PC2</th><th scope=col>Compartment</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>617</th><td>NS_8</td><td>NS</td><td> 4.10482</td><td> 5.895808</td><td>-2.4970339</td><td>NLF</td></tr>
	<tr><th scope=row>616</th><td>NS_7</td><td>NS</td><td>15.67143</td><td> 1.598828</td><td>-2.9971611</td><td>NLF</td></tr>
	<tr><th scope=row>792</th><td>NS_9</td><td>NS</td><td>15.09329</td><td>-1.987749</td><td>-2.0109247</td><td>NLF</td></tr>
	<tr><th scope=row>528</th><td>NS_6</td><td>NS</td><td>14.47520</td><td>-4.300364</td><td>-0.3413821</td><td>NLF</td></tr>
	<tr><th scope=row>527</th><td>NS_6</td><td>NS</td><td>11.06131</td><td>-4.300364</td><td>-0.3413821</td><td>NLF</td></tr>
	<tr><th scope=row>526</th><td>NS_6</td><td>NS</td><td>10.27421</td><td>-4.300364</td><td>-0.3413821</td><td>NLF</td></tr>
</tbody>
</table>



### PCA Plot


```R
options(repr.plot.width=15, repr.plot.height=10) #changing size
ggplot() + 
  geom_point(data = eigenvector_values, aes(x = PC1, y = PC2, color = Group, shape = Group), size = 4) +
#   geom_text_repel(aes(label = Protein), 
#                   show.legend = FALSE, size = 4.5) + 
  geom_polygon(data = hull_values, aes(x = PC1, y = PC2, group = Group, fill = Group, color = Group),
                                       alpha = 0.25, show.legend = FALSE) + 
  
  facet_wrap(~Compartment, scales = 'free') + 

  theme_light() + 
  theme(axis.text.x = element_text(vjust = 0.5), #rotating x labels/ moving x labels slightly to the left
        axis.line = element_line(colour="black"), #making x and y axes black
        axis.text = element_text(size = 13), #changing size of x axis labels
        axis.title = element_text(face = "bold", size = rel(1.7)), #changes axis titles
        legend.title = element_text(face = 'bold', size = 17), #changes legend title
        legend.text = element_text(size = 14), #changes legend text
        legend.position = 'bottom',
        legend.background = element_rect(colour = 'black', fill = 'white', linetype = 'solid'),
        strip.text.x = element_text(size = 18, face = "bold"), #changes size of facet x axis 
        strip.text.y = element_text(size = 18, face = "bold")) + #changes size of facet y axis 
  xlab('Dimension 1') + ylab('Dimension 2')  #changing axis labels 
```


    
![png](output_32_0.png)
    


## Additional Resources
- https://blog.datawrapper.de/colorguide/
- https://ggplot2-book.org/
- https://towardsdatascience.com/beginners-guide-to-enhancing-visualizations-in-r-9fa5a00927c9


```R

```
